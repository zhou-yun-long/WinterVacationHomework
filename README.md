# WinterVacationHomework
#çˆ¬è™«å®æˆ˜ï¼šçˆ¬å–è±†ç“£çƒ­è¯„




| åšå®¢ç­çº§   | <https://edu.cnblogs.com/campus/fzzcxy/Freshman/>     |
| ---------- | -------------------------------------- |
| ä½œä¸šè¦æ±‚   | <https://edu.cnblogs.com/campus/fzzcxy/Freshman/homework/11734>               |
| ä½œä¸šç›®æ ‡   | <å­¦ä¹ çˆ¬è™«ï¼Œå¹¶å…»æˆä½¿ç”¨Git è¿›è¡Œæºä»£ç ç®¡ç†çš„ä¹ æƒ¯>           |
| ä½œä¸šæºä»£ç  | <> |
| å­¦å·       | <212003180>                       |

## å‰æœŸå‡†å¤‡å·¥ä½œ
é¦–å…ˆæ˜¯äº†è§£å¦‚ä½•é‡‡é›†æ•°æ®æˆ‘é€šè¿‡ä»¥ä¸‹å‡ ä¸ªåšä¸»çš„åˆ†äº«å¯¹ç½‘ç»œçˆ¬è™«æœ‰äº†åˆæ­¥çš„äº†è§£




[Pythonç½‘ç»œçˆ¬è™«æ•°æ®é‡‡é›†å®æˆ˜ï¼šåŸºç¡€çŸ¥è¯†](https://blog.csdn.net/qq_36936730/article/details/104601398)
[ä¸€ä¸ªç®€å•çš„ç½‘ç«™çˆ¬è™«æ•™ç¨‹ï¼Œè®©ä½ äº†è§£çˆ¬è™«çš„æ­¥éª¤ï¼Œçˆ¬è™«ç½‘é¡µæ•°æ®é‡‡é›†](https://blog.csdn.net/m0_48405781/article/details/109161890)
[Pythonçˆ¬è™«å…¥é—¨æ•™ç¨‹ï¼æ‰‹æŠŠæ‰‹æ•™ä¼šä½ çˆ¬å–ç½‘é¡µæ•°æ®](https://blog.csdn.net/weixin_52400971/article/deta/109643805?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-1&spm=1001.2101.3001.4242)


å¼€å§‹æ•°æ®é‡‡é›†éœ€è¦çš„å¼€å‘å¹³å°å’Œç¯å¢ƒ

windows
pycharm

###å¯¹äºæ–°äººæ¥è¯´å®‰è£…å„ç§å„æ ·çš„æ¨¡å—å°±æ˜¯ä¸€å¤§å…³ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡Pycharmæˆ–è€…PIPå®‰è£…çš„ï¼Œä½†æ˜¯åœ¨å®‰è£…æ—¶æ€»æ˜¯ä¼šæç¤ºé”™è¯¯ï¼Œå¦‚ä¸‹ï¼š


æœ‰äº›å›¾å¿˜è®°ä¿å­˜äº†ğŸ¤£

è¿™é‡Œé™„ä¸Šæˆ‘è§£å†³è¿™äº›é—®é¢˜æ‰€ç”¨çš„æ–¹æ³•ï¼š

åˆšå¼€å§‹å› ä¸ºä¸çŸ¥é“Pycharmä¸Šçš„åº“è¦é‡æ–°å®‰è£…ï¼Œæ‰€ä»¥ä¸€ç›´åœ¨ç”¨pipå®‰è£…ä½†æ˜¯ä¸€ç›´ä¸è¡Œï¼Œæç¤ºæˆ‘è¦æ›´æ–°pipï¼Œ
åœ¨ç½‘ä¸Šæ‰¾äº†å„ç§æ–¹æ³•éƒ½æ²¡ç”¨ï¼Œåæ¥æˆ‘å°±è¯•ç€æŠŠæˆ‘çš„3.8çš„ç‰ˆæœ¬æ¢æˆ3.9çš„ç»ˆäºæ¬§å…‹äº†ã€‚
 ![](https://img2020.cnblogs.com/blog/2291939/202102/2291939-20210225192220608-1887063665.png)

åœ¨pycharmä¸Šæœ‰äº›åº“ä¹Ÿå®‰è£…ä¸äº†ï¼Œæˆ‘ç”¨çš„è¿™ä¸ªæ–¹æ³•è§£å†³çš„

 [pythonæˆåŠŸå®‰è£…jiebaåº“ï¼Œä½†æ˜¯pycharmä¸­æ— æ³•è¯†åˆ«jiebaçš„è§£å†³æ–¹æ³•](https://blog.csdn.net/weixin_44115959/article/details/104088986)





## çˆ¬è™«å®æˆ˜ï¼šçˆ¬å–è±†ç“£çƒ­è¯„
çˆ¬å–å¯¹è±¡ï¼šä½ å¥½ï¼Œæç„•è‹±

## ä¸€ã€æŠ“å–ç½‘é¡µæ•°æ®

### ç¬¬ä¸€æ­¥è¦å¯¹ç½‘é¡µè¿›è¡Œè®¿é—®ï¼Œä½¿ç”¨çš„æ˜¯requestsåº“ã€‚ä»£ç å¦‚ä¸‹

```
    # requestså“åº”
    r = requests.get(url=url, headers=head)
    # è®¾ç½®ç¼–ç 
    r.encoding = "utf-8"
    html = r.text
```
![](https://img2020.cnblogs.com/blog/2291939/202102/2291939-20210226201031920-1609043127.png)
é‡åˆ°è¿™ç§æƒ…å†µprint(r)å¾—åˆ°`<Response [418]>`è¯·æ±‚æˆåŠŸçš„è¯åº”è¯¥æ˜¯`<Response [200]>`
 
ç™¾åº¦äº†è§£åˆ°è¿™æ˜¯æ‰€è®¿é—®çš„ç½‘ç«™æœ‰åçˆ¬æœºåˆ¶
ä½†æ˜¯æˆ‘å·²ç»ä¼ªè£…äº†å•Š
ç™¾åº¦å¾—åˆ°çš„å»ºè®® é€‰æ‹©å…ˆ ç™»é™† è±†ç“£ç½‘ç«™ï¼Œå†æ›´æ–°ç½‘ç«™å…ƒç´ ï¼ˆF5åˆ·æ–°ï¼‰ï¼Œå†æ¬¡å¤åˆ¶Cookies       
print(r)![](https://img2020.cnblogs.com/blog/2291939/202102/2291939-20210226201514686-1808470880.png)






## ç¬¬äºŒæ­¥ï¼Œéœ€è¦å¯¹å¾—åˆ°çš„htmlä»£ç è¿›è¡Œè§£æï¼Œå¾—åˆ°é‡Œé¢æå–æˆ‘ä»¬éœ€è¦çš„æ•°æ®ã€‚

å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œåˆ†æ
![](https://img2020.cnblogs.com/blog/2291939/202102/2291939-20210225193441960-1495516647.png)

å‘ç°çŸ­è¯„å­˜æ”¾åœ¨```<span class="short">```å’Œ```</span>```ä¹‹é—´ï¼Œæ‰€ä»¥éœ€è¦çˆ¬å–å…¶é‡Œè¾¹çš„å†…å®¹ã€‚

 æ­£åˆ™è¡¨è¾¾å¼ç­›é€‰ï¼ˆæå–æ‰€éœ€è¦ä¿¡æ¯ï¼‰```notice_types = re.findall(r'<span class="short">(.*?)</span>', html)```

æå–åˆ°è¿™ä¸€é¡µçš„è¯„è®ºä¿¡æ¯
![](https://img2020.cnblogs.com/blog/2291939/202102/2291939-20210225194526760-206661868.png)

ä½†æ˜¯è¿™åªæ˜¯ç¬¬ä¸€é¡µçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬åˆ†æå‰å‡ é¡µçš„ **url**


https://movie.douban.com/subject/34841067/comments?start=20&limit=20&status=P&sort=new_score


https://movie.douban.com/subject/34841067/comments?start=40&limit=20&status=P&sort=new_score


https://movie.douban.com/subject/34841067/comments?start=60&limit=20&status=P&sort=new_score

å‘ç°æ¯ç¿»ä¸€é¡µ  start=  å°±å¢åŠ  **20**

æ‰€ä»¥é€šè¿‡æ”¹å˜ start çš„å€¼å°±å¯ä»¥çˆ¬å–å¤šä¸ªç½‘é¡µäº† 
  
è¿™é‡Œä½¿ç”¨é‡‡ç”¨ for å¾ªç¯è¯­å¥æ§åˆ¶é¡µæ•°

```page = 10
for i in range(1, page + 1):
    url = 'https://movie.douban.com/subject/34841067/comments?start=%s&limit=20&sort=new_score&status=P' \
          % ((i - 1) * 20) 
```
æ‰“å°ä¸‹ url  å‘ç°æœ‰å¤šä¸ªurlè¢«æ‰“å°å‡ºæ¥ï¼ŒæˆåŠŸ

![](https://img2020.cnblogs.com/blog/2291939/202102/2291939-20210225195602810-1556033337.png)

æ•°æ®å·²ç»æå–æˆåŠŸï¼Œæ¥ä¸‹æ¥è¦è¿›è¡Œè¯é¢‘ç»Ÿè®¡ï¼Œæ‰€ä»¥å…ˆè¦è¿›è¡Œä¸­æ–‡åˆ†è¯æ“ä½œã€‚åœ¨è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ç»“å·´åˆ†è¯ã€‚

```
comments = []
    with open('demo.csv','r',encoding="utf-8")as csvfile:
        data = csvfile.readlines()

        for item in data:
            #print(item)
            comments.append(item)
            comment_after_split = jieba.cut(str(comments))
    words = ' '.join(comment_after_split)
```

##ä¸‰ã€ç”¨è¯äº‘è¿›è¡Œæ˜¾ç¤º

ä»£ç å¦‚ä¸‹ï¼š
```
import jieba
import os
    def drwawordcloud(title, savapath='/images'):
         if not os.path.exists(savapath):
         os.mkdir(savapath)
    wc = WordCloud(font_path='simkai.ttf',background_color='white', max_words=20000, width=1920, height=1080'))
#æ ¹æ®æ–‡æœ¬ç”Ÿæˆè¯äº‘
    wc.generate_from_text(words)
    filepath = savapath + '/'+title + ',png'
    wc.to_file(filepath)
drwawordcloud('demo')

```

![](https://img2020.cnblogs.com/blog/2291939/202102/2291939-20210225201913166-1044099997.png)


è·å–è¯äº‘åå‘ç°æœ‰å¥½å¤šæ— æ•ˆè¯

æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸‹æ•°æ®æ¸…æ´—
å…ˆåˆ°è¿™ï¼Œè¿˜ä¸ä¼šæ•°æ®æ¸…æ´—ğŸ˜¶ï¼Œåé¢å†æ›´æ–°ã€‚

æ›´æ–°æ¥äº†

```
lastwords = ''
for word in comment_after_split:  # forå¾ªç¯éå†åˆ†è¯åçš„æ¯ä¸ªè¯è¯­
    if word not in stopwords and len(word) > 1:  # åˆ¤æ–­åˆ†è¯åçš„è¯è¯­æ˜¯å¦åœ¨åœç”¨è¯è¡¨å†…,ä¸”lené•¿åº¦æ˜¯å¦å¤§äº1
        if word != '\t':
            lastwords += word
            lastwords += "/"
```

æ¸…æ´—åå†ç”Ÿæˆçš„è¯äº‘
![](https://img2020.cnblogs.com/blog/2291939/202102/2291939-20210226172931967-1021819802.png)

[ä¸­æ–‡åˆ†è¯åå»é™¤åœç”¨è¯](https://blog.csdn.net/sk_berry/article/details/105114318)


   **å®Œæ•´çš„ä»£ç **
```
import csv
import requests
import re

# è®¾ç½®å¤´éƒ¨å’Œcookieï¼Œåçˆ¬ï¼Œä¼ªè£…
head = {
    'Cookie': 'bid=HNf-ab2-lJI; gr_user_id=031667b7-5f8a-4ede-b695-e52d9181fe11; __gads=ID=60db1851df53b133:T=1583253085:S=ALNI_MbBwCgmPG1hMoA4-Z0HSw_zcT0a0A; _vwo_uuid_v2=DD32BB6F8D421706DCD1CDE1061FB7A45|ef7ec70304dd2cf132f1c42b3f0610e7; viewed="1200840_27077140_26943161_25779298"; ll="118165"; __yadk_uid=5OpXTOy4NkvMrHZo7Rq6P8VuWvCSmoEe; ct=y; ap_v=0,6.0; push_doumail_num=0; push_noty_num=0; _pk_ref.100001.4cf6=%5B%22%22%2C%22%22%2C1583508410%2C%22https%3A%2F%2Fwww.pypypy.cn%2F%22%5D; _pk_ses.100001.4cf6=*; dbcl2="131182631:x7xeSw+G5a8"; ck=9iia; _pk_id.100001.4cf6=17997f85dc72b3e8.1583492846.4.1583508446.1583505298.',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36 OPR/66.0.3515.115'}
# è¯·æ±‚ç½‘é¡µ
page = 10

for i in range(1, page + 1):
    url = 'https://movie.douban.com/subject/34841067/comments?start=%s&limit=20&sort=new_score&status=P' \
          % ((i - 1) * 20)
    #print(url)
    # requestså“åº”
    r = requests.get(url=url, headers=head)
    # è®¾ç½®ç¼–ç 
    r.encoding = "utf-8"
    html = r.text
    # æ­£åˆ™è¡¨è¾¾å¼ç­›é€‰ï¼ˆæå–æ‰€éœ€è¦ä¿¡æ¯ï¼‰
    notice_types = re.findall(r'<span class="short">(.*?)</span>', html)
    #print(notice_types)
    with open('demo.csv', 'a', newline="", encoding="utf-8-sig")as csvfile:
       writer = csv.writer(csvfile)
       writer.writerow(notice_types)

```

```
import os
from wordcloud import WordCloud
import jieba

comments = []
with open('demo.csv', 'r', encoding="utf-8") as csvfile: # æ‰“å¼€å­˜å‚¨äº†è¯„è®ºçš„æ–‡æœ¬
    data = csvfile.readlines()  #  è¯»å–æ–‡æœ¬æ•°æ®
    for item in data:
        # print(item)
        comments.append(item)
    comment_after_split = jieba.lcut(str(comments))  #jiebaåˆ†è¯

with open('stop_words.txt', 'r', encoding="utf-8") as f:  # æ‰“å¼€åœç”¨è¯æ–‡æœ¬
    stopwords = f.readlines()  # è¯»å–åœç”¨è¯æ–‡æœ¬æ•°æ®

lastwords = ''
for word in comment_after_split:  # forå¾ªç¯éå†åˆ†è¯åçš„æ¯ä¸ªè¯è¯­
    if word not in stopwords and len(word) > 1:  # åˆ¤æ–­åˆ†è¯åçš„è¯è¯­æ˜¯å¦åœ¨åœç”¨è¯è¡¨å†…
        if word != '\t':
            lastwords += word
            lastwords += ""
print(lastwords)

# åˆ›å»ºæ–‡ä»¶å¤¹images
def drwawordcloud(title, savapath='./images'):
    if not os.path.exists(savapath):
        os.mkdir(savapath)
#è¯äº‘çš„æ ·å¼
    wc = WordCloud(font_path='simkai.ttf', background_color='white', max_words=20000, width=1920, height=1080)
    # æ ¹æ®æ–‡æœ¬ç”Ÿæˆè¯äº‘
    wc.generate_from_text(lastwords)
    filepath = savapath + '/' + title + '.png'
    wc.to_file(filepath)
drwawordcloud('demo')
```

















å‚è€ƒèµ„æ–™ï¼š
[Pythonç½‘ç»œçˆ¬è™«æ•°æ®é‡‡é›†å®æˆ˜ï¼šåŸºç¡€çŸ¥è¯†](https://blog.csdn.net/qq_36936730/article/details/104601398)
[ä¸€ä¸ªç®€å•çš„ç½‘ç«™çˆ¬è™«æ•™ç¨‹ï¼Œè®©ä½ äº†è§£çˆ¬è™«çš„æ­¥éª¤ï¼Œçˆ¬è™«ç½‘é¡µæ•°æ®é‡‡é›†](https://blog.csdn.net/m0_48405781/article/details/109161890)
[Pythonçˆ¬è™«å…¥é—¨æ•™ç¨‹ï¼æ‰‹æŠŠæ‰‹æ•™ä¼šä½ çˆ¬å–ç½‘é¡µæ•°æ®](https://blog.csdn.net/weixin_52400971/article/deta/109643805?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-1&spm=1001.2101.3001.4242)
[ä¸­æ–‡åˆ†è¯åå»é™¤åœç”¨è¯](https://blog.csdn.net/sk_berry/article/details/105114318)

